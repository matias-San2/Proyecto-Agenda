<!DOCTYPE html>
<html lang="<%= lang %>">
<head>
  <meta charset="UTF-8">
  <title><%= t('login.title') %></title>
  <link rel="stylesheet" href="/css/login.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
<div class="wrapper">
  <div class="login-box">
    <form method="POST" action="/login" id="loginForm">
      <h2><%= t('login.title') %></h2>

      <% if (error_msg && error_msg.length) { %>
        <div class="messages-container">
          <% error_msg.forEach(msg => { %>
            <div class="alert alert-danger fade-in">
              <i class="fa-solid fa-exclamation-circle"></i>
              <%= msg %>
            </div>
          <% }) %>
        </div>
      <% } %>

      <div class="input-box">
        <span class="icon"><i class="fa-solid fa-user"></i></span>
        <input type="email" name="correo" id="email" required
               value="<%= form_data ? form_data.correo : '' %>"
               class="<%= form_errors && form_errors.email ? 'error' : '' %>">
        <label><%= t('login.email') %></label>
        <div class="error-message" id="email-error"></div>
      </div>

      <div class="input-box">
        <span class="icon">
          <i class="fa-solid fa-eye" id="togglePassword" title="<%= t('login.show_password') %>"></i>
        </span>
        <input type="password" name="password" id="password" required
               class="<%= form_errors && form_errors.password ? 'error' : '' %>">
        <label><%= t('login.password') %></label>
        <div class="error-message" id="password-error"></div>
      </div>

      <div class="remember-forgot">
        <label><input type="checkbox" name="remember_me"> <%= t('login.remember_me') %></label>
        <a href="#" onclick="showForgotPassword()"><%= t('login.forgot_password') %></a>
      </div>

      <button type="submit" id="loginButton">
        <span class="button-text"><%= t('login.login_button') %></span>
        <div class="spinner" id="spinner" style="display:none;">
          <i class="fa-solid fa-spinner fa-spin"></i>
        </div>
      </button>

      <div class="helper-link mt-3" style="text-align:center;">
        <p style="color:#fff; font-size:0.95rem;">
          ¿No tienes usuarios creados aún?
          <a href="/setup" style="color:#93c5fd; text-decoration:underline;" onclick="return confirm('¿Ir a la configuración inicial? Úsalo solo si no existen usuarios en Cognito.');">
            Ir a configuración inicial
          </a>
        </p>
      </div>
    </form>
  </div>
</div>

<script src="/js/login.js"></script>
</body>
</html>
